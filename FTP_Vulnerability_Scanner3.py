# -*- coding: utf-8 -*-
"""
Created on Sat Aug  4 11:46:23 2018

@author: bharg
"""

import socket
def getBanner(ip,port):
  try:
      socket.setdefaulttimeout(2)
      s = socket.socket()
      s.connect((ip,port))
      banner = s.recv(1024)
      return banner
  except Exception, e:
      print "Error = %s" %str(e)

def checkVulns(banner):
    if ('FreeFloat FTP Server (Version 1.00)' in banner):
        print "Free Float FTP Server is vulnerable"
    elif ('3Com 3CDaemon FTP Server Version 2.0' in banner):
        print "3CDaemon FTP Server is vulnerable"
    elif ('Ability Server 2.34' in banner):
        print "The Ability Server is vulnerable"
    elif ('Sami FTP Server 2.0.2' in banner):
        print "Sami FTP Server is vulnerable"
    else:
        print "The FTP Server is not Vulnerable"
    return

def main():
 ports = [21,22,25,80,110,443]
 for x in range(1,255):
   ip = '192.168.134.%d' %(x)
   for port in ports:
     banner = getBanner(ip,port)
     if banner:
         print " IP: %s and port is %d  and %s is the banner" %(ip, port, banner)
         checkVulns(banner)

if __name__ == '__main__':
    main()